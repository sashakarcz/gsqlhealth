//line /home/sasha/gsqlhealth/internal/database/interface.go:1:1
package database

import (
	"context"
	"fmt"
	"time"
)

// HealthResult represents the result of a health check query
type HealthResult struct {
	DatabaseName string                 `json:"database_name"`
	TableName    string                 `json:"table_name"`
	Status       string                 `json:"status"`
	Data         map[string]interface{} `json:"data,omitempty"`
	Error        string                 `json:"error,omitempty"`
	QueryTime    time.Duration          `json:"query_time"`
	Timestamp    time.Time              `json:"timestamp"`
}

// ConnectionInfo holds database connection information
type ConnectionInfo struct {
	Host     string
	Port     int
	Username string
	Password string
	Database string
	SSLMode  string
	Timeout  time.Duration
}

// Driver interface defines the contract for database drivers
type Driver interface {
	// Connect establishes a connection to the database
	Connect(ctx context.Context, info ConnectionInfo) error

	// Close closes the database connection
	Close() error

	// ExecuteHealthCheck executes a health check query
	ExecuteHealthCheck(ctx context.Context, query string) (map[string]interface{}, error)

	// Ping tests the database connection
	Ping(ctx context.Context) error

	// GetDriverName returns the name of the database driver
	GetDriverName() string
}

// Manager manages database connections and health checks
type Manager struct {
	drivers map[string]Driver
}

// NewManager creates a new database manager
func NewManager() *Manager {goCover_d9c7f9aa98b6__0[0] = 1 ; goCover_d9c7f9aa98b6__0[1] = goCover_d9c7f9aa98b6_P ; goCover_d9c7f9aa98b6__0[2] = 0 ; goCover_d9c7f9aa98b6__0[3] = 1;
	return &Manager{
		drivers: make(map[string]Driver),
	}
}

// RegisterDriver registers a database driver
func (m *Manager) RegisterDriver(dbType string, driver Driver) {goCover_d9c7f9aa98b6__1[0] = 1 ; goCover_d9c7f9aa98b6__1[1] = goCover_d9c7f9aa98b6_P ; goCover_d9c7f9aa98b6__1[2] = 1 ; goCover_d9c7f9aa98b6__1[3] = 1;
	m.drivers[dbType] = driver
}

// GetDriver returns a driver for the specified database type
func (m *Manager) GetDriver(dbType string) (Driver, error) {goCover_d9c7f9aa98b6__2[0] = 3 ; goCover_d9c7f9aa98b6__2[1] = goCover_d9c7f9aa98b6_P ; goCover_d9c7f9aa98b6__2[2] = 2 ; goCover_d9c7f9aa98b6__2[3] = 1;
	driver, exists := m.drivers[dbType]
	if !exists {goCover_d9c7f9aa98b6__2[5] = 1;
		return nil, fmt.Errorf("unsupported database type: %s", dbType)
	}
	goCover_d9c7f9aa98b6__2[4] = 1;return driver, nil
}

// GetSupportedTypes returns a list of supported database types
func (m *Manager) GetSupportedTypes() []string {goCover_d9c7f9aa98b6__3[0] = 3 ; goCover_d9c7f9aa98b6__3[1] = goCover_d9c7f9aa98b6_P ; goCover_d9c7f9aa98b6__3[2] = 3 ; goCover_d9c7f9aa98b6__3[3] = 1;
	types := make([]string, 0, len(m.drivers))
	for dbType := range m.drivers {goCover_d9c7f9aa98b6__3[5] = 1;
		types = append(types, dbType)
	}
	goCover_d9c7f9aa98b6__3[4] = 1;return types
}

// DriverFactory creates database drivers
type DriverFactory struct{}

// NewDriverFactory creates a new driver factory
func NewDriverFactory() *DriverFactory {goCover_d9c7f9aa98b6__4[0] = 1 ; goCover_d9c7f9aa98b6__4[1] = goCover_d9c7f9aa98b6_P ; goCover_d9c7f9aa98b6__4[2] = 4 ; goCover_d9c7f9aa98b6__4[3] = 1;
	return &DriverFactory{}
}

// CreateDriver creates a new driver instance for the specified database type
func (f *DriverFactory) CreateDriver(dbType string) (Driver, error) {goCover_d9c7f9aa98b6__5[0] = 5 ; goCover_d9c7f9aa98b6__5[1] = goCover_d9c7f9aa98b6_P ; goCover_d9c7f9aa98b6__5[2] = 5 ; goCover_d9c7f9aa98b6__5[3] = 1;
	switch dbType {
	case "mysql":goCover_d9c7f9aa98b6__5[4] = 1;
		return NewMySQLDriver(), nil
	case "postgres":goCover_d9c7f9aa98b6__5[5] = 1;
		return NewPostgreSQLDriver(), nil
	case "mssql":goCover_d9c7f9aa98b6__5[6] = 1;
		return NewMSSQLDriver(), nil
	default:goCover_d9c7f9aa98b6__5[7] = 1;
		return nil, fmt.Errorf("unsupported database type: %s", dbType)
	}
}